C:\Users\sari\Desktop\DeepCover\models\A2C\train.py:52: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  state = torch.tensor(state)
C:\Users\sari\Desktop\DeepCover\models\A2C\train.py:67: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  s1 = torch.tensor(s1)
C:\Users\sari\Desktop\DeepCover\models\A2C\train.py:89: UserWarning: Using a target size (torch.Size([1])) that is different to the input size (torch.Size([])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  loss_critic = F.smooth_l1_loss(y_predicted, y_expected)
episode num: 0
Step:50 loss_critic:0.00020039158117792885 loss_actor:tensor([[-0.0222]], grad_fn=<MulBackward0>)
Step:100 loss_critic:4.352797073580573e-06 loss_actor:tensor([[-0.0383]], grad_fn=<MulBackward0>)
Step:150 loss_critic:0.00021906524415822457 loss_actor:tensor([[-0.0381]], grad_fn=<MulBackward0>)
Step:200 loss_critic:0.00016300486540659547 loss_actor:tensor([[-0.0658]], grad_fn=<MulBackward0>)
Step:250 loss_critic:0.001675041775626219 loss_actor:tensor([[-0.0995]], grad_fn=<MulBackward0>)
Step:300 loss_critic:7.969429379788706e-05 loss_actor:tensor([[-0.0645]], grad_fn=<MulBackward0>)
Step:350 loss_critic:7.421459837194526e-05 loss_actor:tensor([[-0.0898]], grad_fn=<MulBackward0>)
Step:400 loss_critic:4.801874400474112e-05 loss_actor:tensor([[-0.1018]], grad_fn=<MulBackward0>)
Step:450 loss_critic:2.3681097583706246e-06 loss_actor:tensor([[-0.1144]], grad_fn=<MulBackward0>)
Step:500 loss_critic:0.0002797216450978007 loss_actor:tensor([[-0.0536]], grad_fn=<MulBackward0>)
Step:550 loss_critic:0.0005288698372935731 loss_actor:tensor([[-0.0599]], grad_fn=<MulBackward0>)
Step:600 loss_critic:3.5966734176173667e-05 loss_actor:tensor([[-0.0406]], grad_fn=<MulBackward0>)
Step:650 loss_critic:0.00041315979098166923 loss_actor:tensor([[0.0274]], grad_fn=<MulBackward0>)
Step:700 loss_critic:3.170238602606622e-08 loss_actor:tensor([[0.0480]], grad_fn=<MulBackward0>)
Step:750 loss_critic:9.25984830871722e-06 loss_actor:tensor([[0.1010]], grad_fn=<MulBackward0>)
Step:800 loss_critic:0.0006406551875031861 loss_actor:tensor([[-0.0061]], grad_fn=<MulBackward0>)
Step:850 loss_critic:0.0006928450570680772 loss_actor:tensor([[0.0259]], grad_fn=<MulBackward0>)
Step:900 loss_critic:9.464538894917872e-05 loss_actor:tensor([[0.0577]], grad_fn=<MulBackward0>)
Step:950 loss_critic:0.0021035251407819184 loss_actor:tensor([[-0.3067]], grad_fn=<MulBackward0>)
Step:1000 loss_critic:1.8546799378045546e-06 loss_actor:tensor([[-0.1888]], grad_fn=<MulBackward0>)
Step:1050 loss_critic:0.000201320152678146 loss_actor:tensor([[-0.6752]], grad_fn=<MulBackward0>)
Step:1100 loss_critic:0.0035984175165317436 loss_actor:tensor([[-0.6211]], grad_fn=<MulBackward0>)
Step:1150 loss_critic:0.001756337373303179 loss_actor:tensor([[-0.7950]], grad_fn=<MulBackward0>)
Step:1200 loss_critic:0.0018655485409899346 loss_actor:tensor([[-0.9887]], grad_fn=<MulBackward0>)
Step:1250 loss_critic:0.006008582519338083 loss_actor:tensor([[-0.9974]], grad_fn=<MulBackward0>)
Step:1300 loss_critic:0.037631926025369584 loss_actor:tensor([[-0.9987]], grad_fn=<MulBackward0>)
Step:1350 loss_critic:0.07556321889620136 loss_actor:tensor([[-0.9995]], grad_fn=<MulBackward0>)
Step:1400 loss_critic:0.14854914278575715 loss_actor:tensor([[-0.9997]], grad_fn=<MulBackward0>)
episode num: 1
Step:50 loss_critic:0.04665044501188475 loss_actor:tensor([[-0.9997]], grad_fn=<MulBackward0>)
Step:100 loss_critic:0.030171244724871118 loss_actor:tensor([[-0.9995]], grad_fn=<MulBackward0>)
Step:150 loss_critic:0.013303083500325864 loss_actor:tensor([[-0.9993]], grad_fn=<MulBackward0>)
Step:200 loss_critic:0.0032645638916487967 loss_actor:tensor([[-0.9988]], grad_fn=<MulBackward0>)
Step:250 loss_critic:0.005076896824776085 loss_actor:tensor([[-0.9978]], grad_fn=<MulBackward0>)
Step:300 loss_critic:0.0002724025649469242 loss_actor:tensor([[-0.9777]], grad_fn=<MulBackward0>)
Step:350 loss_critic:2.2497217350613864e-05 loss_actor:tensor([[-0.9793]], grad_fn=<MulBackward0>)
Step:400 loss_critic:4.491320611748657e-05 loss_actor:tensor([[-0.9957]], grad_fn=<MulBackward0>)
Step:450 loss_critic:0.0001232167382218828 loss_actor:tensor([[-0.9968]], grad_fn=<MulBackward0>)
Step:500 loss_critic:0.0003570023769924097 loss_actor:tensor([[-0.9972]], grad_fn=<MulBackward0>)
Step:550 loss_critic:0.000715404512113476 loss_actor:tensor([[-0.9745]], grad_fn=<MulBackward0>)
Step:600 loss_critic:0.0006958519084533866 loss_actor:tensor([[-0.9879]], grad_fn=<MulBackward0>)
Step:650 loss_critic:8.535489411869283e-05 loss_actor:tensor([[-0.8670]], grad_fn=<MulBackward0>)
Step:700 loss_critic:0.00019712984010924057 loss_actor:tensor([[-0.8668]], grad_fn=<MulBackward0>)
Step:750 loss_critic:0.00010765802239208139 loss_actor:tensor([[-0.8229]], grad_fn=<MulBackward0>)
Step:800 loss_critic:8.908536701311472e-05 loss_actor:tensor([[-0.9179]], grad_fn=<MulBackward0>)
Step:850 loss_critic:2.8113484631177786e-05 loss_actor:tensor([[-0.9232]], grad_fn=<MulBackward0>)
Step:900 loss_critic:0.00037251708244207606 loss_actor:tensor([[-0.8819]], grad_fn=<MulBackward0>)
Step:950 loss_critic:0.01510938180774606 loss_actor:tensor([[-0.9951]], grad_fn=<MulBackward0>)
Step:1000 loss_critic:0.004806838464774559 loss_actor:tensor([[-0.9990]], grad_fn=<MulBackward0>)
Step:1050 loss_critic:0.0781509739450539 loss_actor:tensor([[-0.9996]], grad_fn=<MulBackward0>)
Step:1100 loss_critic:0.12498814718800473 loss_actor:tensor([[-0.9998]], grad_fn=<MulBackward0>)
Step:1150 loss_critic:0.1473050544943831 loss_actor:tensor([[-0.9999]], grad_fn=<MulBackward0>)
Step:1200 loss_critic:0.23689506981641328 loss_actor:tensor([[-0.9999]], grad_fn=<MulBackward0>)
Step:1250 loss_critic:0.22815853195844507 loss_actor:tensor([[-0.9999]], grad_fn=<MulBackward0>)
Step:1300 loss_critic:0.29562138578535374 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1350 loss_critic:0.3312853605815198 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1400 loss_critic:0.40814169556761065 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
episode num: 2
Step:50 loss_critic:0.00020238610807407203 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:100 loss_critic:0.00010222756862426162 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:150 loss_critic:0.00010192967538951234 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:200 loss_critic:0.0021473913531467226 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:250 loss_critic:0.0006271318789882258 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:300 loss_critic:0.0019726879398736783 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:350 loss_critic:0.0018128153891899578 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:400 loss_critic:0.003388331610913966 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:450 loss_critic:0.0030617980135736167 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:500 loss_critic:0.00029780049489893843 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:550 loss_critic:3.79920552254321e-05 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:600 loss_critic:5.765796741816512e-06 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:650 loss_critic:0.004207409471303797 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:700 loss_critic:0.0049728717405076 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:750 loss_critic:0.008066340824911965 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:800 loss_critic:0.0007922885426206454 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:850 loss_critic:0.00021367545673290223 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:900 loss_critic:0.003573307883909436 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:950 loss_critic:0.026465044918833107 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1000 loss_critic:0.012525528985778607 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1050 loss_critic:0.09979738755008169 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1100 loss_critic:0.14972956998782772 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1150 loss_critic:0.1710174348218183 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1200 loss_critic:0.2630611220612174 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1250 loss_critic:0.24984880025472478 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1300 loss_critic:0.31613038086450096 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1350 loss_critic:0.34903199099309334 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1400 loss_critic:0.4239347257038044 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
episode num: 3
Step:50 loss_critic:2.1495870933066392e-05 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:100 loss_critic:6.940167794475873e-06 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:150 loss_critic:0.0002532491943804021 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:200 loss_critic:0.0025828990022590524 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:250 loss_critic:0.000813078549526381 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:300 loss_critic:0.002223077577949515 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:350 loss_critic:0.002001733473068321 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:400 loss_critic:0.0035902538602327083 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:450 loss_critic:0.003214651185032182 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:500 loss_critic:0.0003372833207315113 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:550 loss_critic:2.7713885925213097e-05 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:600 loss_critic:2.7827151285333075e-06 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:650 loss_critic:0.004129140835435841 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:700 loss_critic:0.004901170714065012 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:750 loss_critic:0.007988935795115821 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:800 loss_critic:0.0007724389667639353 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:850 loss_critic:0.00020484158911725456 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:900 loss_critic:0.00354149325733221 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:950 loss_critic:0.026537883432663785 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1000 loss_critic:0.012569132825463307 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1050 loss_critic:0.09990491787146892 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1100 loss_critic:0.14984456848375793 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1150 loss_critic:0.17112541051006497 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1200 loss_critic:0.2631763098722808 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1250 loss_critic:0.24994837339292497 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1300 loss_critic:0.31622768973949794 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1350 loss_critic:0.34912153725893075 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:1400 loss_critic:0.4240207884994133 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
episode num: 4
Step:50 loss_critic:2.0944493689210777e-05 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:100 loss_critic:6.668844559492611e-06 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:150 loss_critic:0.00025469597867524576 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:200 loss_critic:0.002586863216241685 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:250 loss_critic:0.0008150218142824173 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:300 loss_critic:0.0022259559802183006 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:350 loss_critic:0.002004189382590716 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:400 loss_critic:0.0035931839049966495 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:450 loss_critic:0.0032171368884107336 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:500 loss_critic:0.000338020607644755 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:550 loss_critic:2.7523841789461332e-05 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:600 loss_critic:2.7288419588140385e-06 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:650 loss_critic:0.004127239838205036 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:700 loss_critic:0.004899264794275381 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Step:750 loss_critic:0.00798670582010091 loss_actor:tensor([[-1.0000]], grad_fn=<MulBackward0>)
Traceback (most recent call last):
  File "C:\Users\sari\Desktop\DeepCover\main.py", line 100, in <module>
    main()
  File "C:\Users\sari\Desktop\DeepCover\main.py", line 78, in main
    loss_critic, loss_actor = trainer.optimize(obs, action, reward, next_obs, args.gamma, args.tau)
  File "C:\Users\sari\Desktop\DeepCover\models\A2C\train.py", line 101, in optimize
    soft_update(self.target_actor, self.actor, tau)
  File "C:\Users\sari\Desktop\DeepCover\models\A2C\update_util.py", line 11, in soft_update
    target_param.data.copy_(
KeyboardInterrupt